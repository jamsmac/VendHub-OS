# Trips Page Specification

## Overview
Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ°Ğ¼Ğ¸ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¾Ğ² (VendtripBot frontend).

## URL Structure
- `/dashboard/trips` - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ĞµĞ·Ğ´Ğ¾Ğº
- `/dashboard/trips/[id]` - Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ¸
- `/dashboard/trips/tracker` - live tracker

## Page: Trips List (`/dashboard/trips`)

### Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: "ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ¸"                        [+ ĞĞ¾Ğ²Ğ°Ñ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ°]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Filters:                                                     â”‚
â”‚ [Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ â–¼] [Ğ¢Ğ¸Ğ¿ â–¼] [Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸Ğº â–¼] [Ğ”Ğ°Ñ‚Ğ° Ğ¾Ñ‚] [Ğ”Ğ°Ñ‚Ğ° Ğ´Ğ¾] [ğŸ”]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Stats Cards:                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ â”‚ â”‚ Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ  â”‚ â”‚ ĞšĞ¼ Ğ²ÑĞµĞ³Ğ¾ â”‚ â”‚ ĞĞ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¸ â”‚        â”‚
â”‚ â”‚    5     â”‚ â”‚   12     â”‚ â”‚  234.5   â”‚ â”‚    3     â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Table:                                                       â”‚
â”‚ â”‚ # â”‚ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸Ğº â”‚ Ğ¢Ğ¸Ğ¿ â”‚ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ â”‚ ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ â”‚ ĞšĞ¼ â”‚ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ â”‚ â”‚
â”‚ â”‚ 1 â”‚ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜. â”‚ ğŸ”§  â”‚ ğŸŸ¢     â”‚ 09:15  â”‚ 45 â”‚ 8         â”‚ â”‚
â”‚ â”‚ 2 â”‚ ĞŸĞµÑ‚Ñ€Ğ¾Ğ² ĞŸ. â”‚ ğŸ“¦  â”‚ ğŸŸ¡     â”‚ 08:30  â”‚ 23 â”‚ 5         â”‚ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pagination: [<] 1 2 3 ... 10 [>]         Showing 1-20 of 45 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Filters
| Field | Type | Options |
|-------|------|---------|
| status | Select | active, completed, cancelled, auto_closed |
| taskType | Select | filling, collection, repair, maintenance, inspection, merchandising, other |
| employeeId | SearchSelect | API: /employees |
| dateFrom | DatePicker | - |
| dateTo | DatePicker | - |

### Table Columns
| Column | Field | Sortable | Format |
|--------|-------|----------|--------|
| # | - | No | Row number |
| Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸Ğº | employee.name | Yes | Avatar + Name |
| Ğ¢Ğ¸Ğ¿ | taskType | Yes | Icon + Label |
| Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | status | Yes | StatusBadge |
| ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ | startedAt | Yes | HH:mm DD.MM |
| Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ | duration | Yes | HH:mm:ss |
| ĞšĞ¼ | calculatedDistanceMeters | Yes | km with 1 decimal |
| ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ | totalStops | Yes | Number |
| ĞĞ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¸ | totalAnomalies | No | Badge (red if > 0) |
| Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ | - | No | View, Map buttons |

### Actions
- **View** â†’ Navigate to `/dashboard/trips/[id]`
- **Map** â†’ Open map modal with route
- **Export** â†’ Download CSV/Excel

## Page: Trip Details (`/dashboard/trips/[id]`)

### Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â† ĞĞ°Ğ·Ğ°Ğ´] Trip #123                      [Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ] [ĞÑ‚Ğ¼ĞµĞ½Ğ°]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Trip Info Card          â”‚ â”‚ Map (Leaflet)               â”‚ â”‚
â”‚ â”‚ â€¢ Ğ¡Ğ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸Ğº: Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜.  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â€¢ Ğ¢Ğ¸Ğ¿: Ğ—Ğ°Ğ¿Ñ€Ğ°Ğ²ĞºĞ°         â”‚ â”‚ â”‚                         â”‚ â”‚ â”‚
â”‚ â”‚ â€¢ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ      â”‚ â”‚ â”‚   [Route polyline]      â”‚ â”‚ â”‚
â”‚ â”‚ â€¢ ĞĞ°Ñ‡Ğ°Ğ»Ğ¾: 09:15         â”‚ â”‚ â”‚   [Stop markers]        â”‚ â”‚ â”‚
â”‚ â”‚ â€¢ ĞšĞ¼: 45.2              â”‚ â”‚ â”‚                         â”‚ â”‚ â”‚
â”‚ â”‚ â€¢ ĞœĞ°ÑˆĞ¸Ğ½Ğ°: Ğ123Ğ‘Ğ’        â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tabs: [ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸] [ĞĞ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¸] [ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚]                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tab Content (ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸):                                     â”‚
â”‚ â”‚ # â”‚ Ğ’Ñ€ĞµĞ¼Ñ â”‚ ĞœĞµÑÑ‚Ğ¾ â”‚ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚ â”‚ Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ â”‚ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ â”‚     â”‚
â”‚ â”‚ 1 â”‚ 09:20 â”‚ ...   â”‚ VM-001  â”‚ 15 Ğ¼Ğ¸Ğ½       â”‚ âœ“      â”‚     â”‚
â”‚ â”‚ 2 â”‚ 09:45 â”‚ ...   â”‚ VM-002  â”‚ 10 Ğ¼Ğ¸Ğ½       â”‚ âœ“      â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Trip Info Fields
- employee (name, avatar)
- vehicle (plateNumber)
- taskType (with icon)
- status (badge)
- startedAt / endedAt
- calculatedDistanceMeters
- totalStops
- totalAnomalies
- visitedMachinesCount

### Tabs

#### Tab: ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ (Stops)
Table columns:
- #, Ğ’Ñ€ĞµĞ¼Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°, ĞœĞµÑÑ‚Ğ¾ (address), ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚ (machine name), Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ, Ğ’ĞµÑ€Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°

#### Tab: ĞĞ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¸ (Anomalies)
Table columns:
- Ğ¢Ğ¸Ğ¿, Ğ¡ĞµÑ€ÑŒÑ‘Ğ·Ğ½Ğ¾ÑÑ‚ÑŒ (badge), ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ, Ğ’Ñ€ĞµĞ¼Ñ, Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ (resolved/not)
Actions: Resolve button

#### Tab: ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚ (Route)
- Full-screen map with route polyline
- All GPS points
- Stop markers with info

### Actions
- **Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ** (End Trip) - POST /trips/:id/end
- **ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ** (Cancel) - POST /trips/:id/cancel
- **Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚** - Download trip report

## Page: Live Tracker (`/dashboard/trips/tracker`)

### Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Live Tracker                              [ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ] [âš™ï¸]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Active Trips List     â”‚ Map (Full width)                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸŸ¢ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ² Ğ˜.      â”‚ â”‚ â”‚                                 â”‚ â”‚
â”‚ â”‚    45.2 ĞºĞ¼        â”‚ â”‚ â”‚   [Multiple employee markers]   â”‚ â”‚
â”‚ â”‚    8 Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¾Ğº    â”‚ â”‚ â”‚   [Live position updates]       â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚                                 â”‚ â”‚
â”‚ â”‚ ğŸŸ¢ ĞŸĞµÑ‚Ñ€Ğ¾Ğ² ĞŸ.      â”‚ â”‚ â”‚                                 â”‚ â”‚
â”‚ â”‚    23.1 ĞºĞ¼        â”‚ â”‚ â”‚                                 â”‚ â”‚
â”‚ â”‚    5 Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¾Ğº    â”‚ â”‚ â”‚                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Features
- WebSocket connection for live updates
- Auto-refresh every 30 seconds
- Click employee card â†’ center map on employee
- Click map marker â†’ show employee info popup

## Components Hierarchy

```
trips/
â”œâ”€â”€ page.tsx (TripsListPage)
â”‚   â”œâ”€â”€ TripFilters
â”‚   â”œâ”€â”€ TripStatsCards
â”‚   â”œâ”€â”€ TripTable
â”‚   â”‚   â”œâ”€â”€ TripStatusBadge
â”‚   â”‚   â””â”€â”€ TripTaskTypeBadge
â”‚   â””â”€â”€ TripMapModal
â”‚
â”œâ”€â”€ [id]/page.tsx (TripDetailPage)
â”‚   â”œâ”€â”€ TripInfoCard
â”‚   â”œâ”€â”€ TripMap
â”‚   â”œâ”€â”€ TripStopsList
â”‚   â”œâ”€â”€ TripAnomaliesList
â”‚   â””â”€â”€ TripRouteTab
â”‚
â””â”€â”€ tracker/page.tsx (TripTrackerPage)
    â”œâ”€â”€ ActiveTripsList
    â”‚   â””â”€â”€ ActiveTripCard
    â””â”€â”€ LiveMap
        â””â”€â”€ EmployeeMarker
```

## API Integration

### Hooks
```typescript
// useTrips.ts
useTrips(filters) â†’ { trips, total, isLoading }
useTrip(id) â†’ { trip, isLoading }
useTripRoute(id) â†’ { points, isLoading }
useTripStops(id) â†’ { stops, isLoading }
useTripAnomalies(id) â†’ { anomalies, isLoading }
useTripStats(filters) â†’ { stats, isLoading }
useActiveTrips() â†’ { trips, isLoading } // for tracker
```

### Mutations
```typescript
useStartTrip() â†’ mutation
useEndTrip() â†’ mutation
useCancelTrip() â†’ mutation
useResolveAnomaly() â†’ mutation
```

## Styling Notes
- Use "Warm Brew" color palette
- Status badges: active=green, completed=blue, cancelled=red, auto_closed=orange
- Task type icons from lucide-react
- Map: Leaflet with OpenStreetMap tiles
- Responsive: sidebar collapses on mobile

## Estimated Time: 20 hours
- List page: 6h
- Detail page: 8h
- Tracker page: 6h
