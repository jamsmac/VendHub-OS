---
name: vhm24-orchestrator
description: |
  VendHub Orchestrator - координация skills для комплексных задач.
  Планирует выполнение через vhm24-* skills, управляет зависимостями.
  Использовать при создании новых экранов, модулей, комплексных фич.
---

# VendHub Skill Orchestrator

Интеллектуальный координатор всех VendHub скиллов для создания качественного продукта.

## Назначение

Превращает запросы на разработку VendHub в структурированные планы с использованием специализированных скиллов. Обеспечивает правильную последовательность: Спецификация -> Код -> Тесты -> Проверка.

## Когда использовать

Активировать при:
- Запросе на создание нового экрана VendHub
- Разработке нового модуля или функции
- Комплексной задаче с несколькими экранами
- Рефакторинге существующих экранов
- Создании нового NestJS модуля с API и UI
- Запросе "сделай экран для...", "создай модуль..."

## Доступные VendHub скиллы

### Основной поток

| Скилл | Назначение | Когда |
|-------|-----------|-------|
| `vhm24-ux-spec` | UX спецификация | ПЕРЕД кодом |
| `vhm24-ui-generator` | Генерация React UI кода | После спецификации |
| `vhm24-qa-review` | Проверка качества | После генерации |

### Специализированные скиллы

| Скилл | Назначение |
|-------|-----------|
| `vhm24-db-expert` | Схема БД, TypeORM сущности, миграции, запросы |
| `vhm24-api-generator` | NestJS модули, контроллеры, сервисы, DTO |
| `vhm24-component-lib` | Кастомные shadcn/ui компоненты |
| `vhm24-i18n` | Русская локализация |
| `vhm24-testing` | Jest тесты для NestJS сервисов, контроллеров, React компонентов |

## Рабочий процесс

### Фаза 1: Анализ задачи

При получении запроса определить:

1. **Тип задачи**:
   - Новый экран (требует полный поток: спецификация -> БД -> API -> UI -> тесты -> QA)
   - Доработка экрана (частичный поток)
   - Новый API модуль (NestJS module + controller + service + DTO без UI)
   - Компонент (без полного экрана)

2. **Сложность**:
   - Простая: 1-2 скилла
   - Средняя: 3-4 скилла
   - Сложная: 5+ скиллов

3. **Зависимости**:
   - Какие TypeORM сущности нужны
   - Какие NestJS REST endpoints требуются
   - Какие Zustand сторы и Axios вызовы на фронтенде
   - Связь с другими экранами и модулями

### Фаза 2: План выполнения

Создать файл `EXECUTION_PLAN.md`:

```markdown
# План: [Название экрана/задачи]

## Обзор
- **Цель**: [Что создаём]
- **Сложность**: [Простая/Средняя/Сложная]
- **Шагов**: [Количество]
- **Создано**: [Дата]

## Прогресс

### Шаг 1: UX Спецификация
- [ ] **Статус**: Ожидание
- **Скилл**: `vhm24-ux-spec`
- **Действие**: Создать спецификацию экрана
- **Выход**: Файл спецификации .md

### Шаг 2: TypeORM сущности и миграции
- [ ] **Статус**: Ожидание
- **Скилл**: `vhm24-db-expert`
- **Действие**: Создать/обновить TypeORM сущности, написать миграции
- **Зависимость**: Шаг 1

### Шаг 3: NestJS модуль (контроллер + сервис + DTO)
- [ ] **Статус**: Ожидание
- **Скилл**: `vhm24-api-generator`
- **Действие**: Создать NestJS модуль с REST контроллером, сервисом и DTO
- **Зависимость**: Шаг 2

### Шаг 4: Генерация UI
- [ ] **Статус**: Ожидание
- **Скилл**: `vhm24-ui-generator`
- **Действие**: Создать React компоненты с Axios API вызовами и Zustand сторами
- **Зависимость**: Шаги 1, 3

### Шаг 5: Jest тесты
- [ ] **Статус**: Ожидание
- **Скилл**: `vhm24-testing`
- **Действие**: Написать тесты для сервисов, контроллеров и компонентов
- **Зависимость**: Шаги 3, 4

### Шаг 6: QA Проверка
- [ ] **Статус**: Ожидание
- **Скилл**: `vhm24-qa-review`
- **Действие**: Проверить качество кода по чеклисту
- **Зависимость**: Шаг 5

---

## Итог
- [ ] Все шаги выполнены
- [ ] Спецификация утверждена
- [ ] TypeORM сущности и миграции созданы
- [ ] NestJS REST endpoints с Swagger документацией
- [ ] React UI с Axios + Zustand
- [ ] Jest тесты проходят
- [ ] Код соответствует стандартам
```

### Фаза 3: Выполнение

#### Последовательный режим (рекомендуется)

Для каждого шага:

1. Прочитать шаг из плана
2. Активировать указанный скилл
3. Выполнить действие
4. Обновить план: `- [ ]` -> `- [x]`
5. Перейти к следующему шагу

#### Параллельный режим

Для независимых шагов (пример: TypeORM сущности + UI компоненты):

```
                   +-> vhm24-db-expert -> vhm24-api-generator -+
                   |                                            |
vhm24-ux-spec ----+                                            +-> vhm24-testing -> vhm24-qa-review
                   |                                            |
                   +-> vhm24-component-lib -> vhm24-ui-generator+
```

## Шаблоны задач

### Новый экран (полный поток)

```
1. vhm24-ux-spec        -> Спецификация экрана
2. vhm24-db-expert      -> TypeORM сущности + миграции
3. vhm24-api-generator  -> NestJS модуль (контроллер + сервис + DTO + Swagger)
4. vhm24-ui-generator   -> React компоненты + Axios API + Zustand стор
5. vhm24-testing        -> Jest тесты (сервис, контроллер, компоненты)
6. vhm24-qa-review      -> Проверка качества
```

### Доработка экрана

```
1. vhm24-ux-spec        -> Спецификация изменений
2. vhm24-ui-generator   -> Изменения React кода
3. vhm24-qa-review      -> Проверка
```

### Новый API endpoint

```
1. vhm24-db-expert      -> TypeORM сущность + миграция
2. vhm24-api-generator  -> NestJS модуль: Module, Controller, Service, DTO, Swagger декораторы
3. vhm24-testing        -> Jest тесты для сервиса и контроллера
```

### Новый компонент

```
1. vhm24-component-lib  -> Дизайн компонента
2. vhm24-ui-generator   -> Реализация
3. vhm24-qa-review      -> Проверка
```

## Координация скиллов

### Передача контекста

Каждый скилл должен получить:
- Результаты предыдущих шагов
- Ссылки на созданные файлы
- Зависимости и требования
- Информацию о TypeORM сущностях (для API генератора)
- Информацию о NestJS endpoints (для UI генератора)

### Обработка ошибок

При ошибке в шаге:
1. Зафиксировать проблему в плане
2. Определить причину
3. Предложить решение или откат
4. Получить подтверждение пользователя

## Примеры

### Пример 1: Экран управления ингредиентами

**Запрос**: "Создай экран для управления ингредиентами"

**План**:
```markdown
### Шаг 1: UX Спецификация
- **Скилл**: `vhm24-ux-spec`
- Проанализировать существующие экраны
- Определить структуру данных ingredients
- Создать wireframe и описание

### Шаг 2: TypeORM сущность
- **Скилл**: `vhm24-db-expert`
- Создать Ingredient entity (extends BaseEntity)
- Колонки: name, unit, quantity, price, organization_id, deleted_at
- Создать миграцию CreateIngredientTable

### Шаг 3: NestJS модуль
- **Скилл**: `vhm24-api-generator`
- IngredientModule, IngredientController, IngredientService
- REST: GET /ingredients, GET /ingredients/:id, POST, PATCH, DELETE
- DTO: CreateIngredientDto, UpdateIngredientDto (с class-validator)
- Swagger документация: @ApiTags, @ApiOperation, @ApiProperty

### Шаг 4: UI Генерация
- **Скилл**: `vhm24-ui-generator`
- IngredientsScreen.tsx (Axios API + Zustand стор)
- IngredientForm.tsx (React Hook Form + валидация)
- IngredientTable.tsx (таблица с пагинацией)

### Шаг 5: Тесты
- **Скилл**: `vhm24-testing`
- ingredient.service.spec.ts (Jest)
- ingredient.controller.spec.ts (Jest)

### Шаг 6: QA
- **Скилл**: `vhm24-qa-review`
- Проверить TypeScript, class-validator, organization_id, soft delete
- Проверить дизайн-систему и dark mode
```

### Пример 2: Добавление фильтра к экрану

**Запрос**: "Добавь фильтр по дате к списку заказов"

**План**:
```markdown
### Шаг 1: Спецификация
- **Скилл**: `vhm24-ux-spec`
- Проанализировать OrdersScreen
- Определить параметры фильтра

### Шаг 2: Реализация
- **Скилл**: `vhm24-ui-generator`
- Добавить DateRangePicker
- Обновить Axios запрос с query параметрами
- Обновить Zustand стор

### Шаг 3: Проверка
- **Скилл**: `vhm24-qa-review`
```

## Ссылки

- `references/skill_workflows.md` - Детальные потоки для каждого типа задачи
- `references/dependencies.md` - Карта зависимостей между скиллами
